<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id=",7f69~kN4}($qQ:zE6,*">strip</variable><variable id="}OizKB)-6aFr5q:Yr4.T">WIFI_MODE</variable><variable id="V}dITmW#v,LO_,[qSx{R">SSID_1</variable><variable id="V`ehez(uX4[-|=P6C:TQ">PASSWORD_1</variable><variable id="fAyQ15?S,3?o$]Ae0vN@">SSID_2</variable><variable id="lD%oltOw!+%Dum{U~oUI">PASSWORD_2</variable><variable id="DmTTO`)sndq?Cr?8S_)5">result</variable><variable id="Q8E,[I-7wj7bOCUL_uLI">serial_str</variable><variable id="Ve@lIP}hfBi#p-9g$`C5">client_ID</variable><variable id="H,F[Hcu~$:h[xaCdK`rC">GET_command</variable><variable id="cSFqRp:bPq~IA+h,4GZj">GET_pos</variable><variable id="E]U,Ac0}siVq2xwur,2C">HTTP_pos</variable></variables><block type="pxt-on-start" id=")xYFn%ttzSjlPt2}7jW*" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="FFAh_R!?/5?ZJ2{N2BI[" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let LED_status: number = 0" numlines="1" declaredvars="LED_status"></mutation><next><block type="typescript_statement" id="O#,A)cC4J_oCy(4FF]tb" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let serial_str: string = &quot;&quot;" numlines="1" declaredvars="serial_str"></mutation><next><block type="typescript_statement" id="p5g,*,ppD;`.G=6UD6[c" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let GET_success: boolean = false" numlines="1" declaredvars="GET_success"></mutation><next><block type="typescript_statement" id="hbrR0R[@I{CUZz~HWIol" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let client_ID = &quot;&quot;" numlines="1" declaredvars="client_ID"></mutation><next><block type="typescript_statement" id="y1P%$-IAJ_qc:`iY]h(R" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let GET_command = &quot;&quot;" numlines="1" declaredvars="GET_command"></mutation><next><block type="device_show_leds" id="cDK4HLEwG?kpw[#p(;zn"><field name="LEDS">`&#10;        # . . . # &#10;        # . . . # &#10;        . . . . . &#10;        . . . . . &#10;        . . . . .&#10;        `</field><next><block type="variables_set" id="m9=Phm2m[mXU49Ps8Nhk"><field name="VAR" id=",7f69~kN4}($qQ:zE6,*">strip</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="neopixel_create" id="OG-$RKN:JZS;H+6X?zEW"><field name="pin">DigitalPin.P1</field><field name="mode">NeoPixelMode.RGB</field><value name="numleds"><shadow type="math_number" id="H7mU`TDg}:g`MHuj7u_A"><field name="NUM">60</field></shadow></value></block></value><next><block type="device_pause" id="H}uCG2(BYW06O#06)qe6"><value name="pause"><shadow type="timePicker" id="BM_`_A:#b.63%sr+}eRK"><field name="ms">100</field></shadow></value><next><block type="neopixel_set_strip_color" id="JmQUzDIW`gut9C;^P{Fb"><value name="strip"><block type="variables_get" id="`,fRmBBW!rBqG9zrN$[{"><field name="VAR" id=",7f69~kN4}($qQ:zE6,*">strip</field></block></value><value name="rgb"><shadow type="neopixel_colors" id="P1pjApH4vyDK^G@0];G4"><field name="color">NeoPixelColors.Red</field></shadow></value><next><block type="neopixel_show" id="//Wi0Q-JlRf^:Wy%gBS-"><value name="strip"><block type="variables_get" id="DXM9bG@w6~nG}wp)F@ks"><field name="VAR" id=",7f69~kN4}($qQ:zE6,*">strip</field></block></value><next><block type="device_set_digital_pin" id="?%q/qXrHUX[T}$KS9utE"><field name="name">DigitalPin.P6</field><value name="value"><shadow type="math_number_minmax" id="gym6$n^V+#JrYdf|Mlpm"><mutation min="0" max="1" label="Number" precision="0"/><field name="SLIDER">0</field></shadow></value><next><block type="device_set_digital_pin" id="[yPn/x(YL)$6d(nzVN3O"><field name="name">DigitalPin.P7</field><comment>basic.pause(2000)</comment><value name="value"><shadow type="math_number_minmax" id="d}nCH}E58tpy$/)05:)h"><mutation min="0" max="1" label="Number" precision="0"/><field name="SLIDER">0</field></shadow></value><next><block type="device_set_digital_pin" id="Oew3MxTjIm`Cu3[r2f?5"><field name="name">DigitalPin.P9</field><comment>basic.pause(2000)</comment><value name="value"><shadow type="math_number_minmax" id=")L.CMfTF9^QcJl5(fM;F"><mutation min="0" max="1" label="Number" precision="0"/><field name="SLIDER">0</field></shadow></value><next><block type="device_show_leds" id="(/QrKyUl#2[!2tV3ikdY"><field name="LEDS">`&#10;        # . . . # &#10;        . # # # . &#10;        . . . . . &#10;        . . . . . &#10;        . . . . .&#10;        `</field><comment>basic.pause(2000)</comment><next><block type="basic_show_icon" id="($[(jy97MZBN:fh]Jt(S"><field name="i">IconNames.No</field><next><block type="variables_set" id="~uVW63%wiE}{l+TiEgyL"><field name="VAR" id="}OizKB)-6aFr5q:Yr4.T">WIFI_MODE</field><value name="VALUE"><shadow type="math_number" id="^j8G;d]:X=#pwMagopmK"><field name="NUM">2</field></shadow></value><next><block type="typescript_statement" id="H[baYbH9!tJ%7(`^/wQ)" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const Tx_pin: SerialPin = SerialPin.P8" numlines="1" declaredvars="Tx_pin"></mutation><next><block type="typescript_statement" id="n#AJFE}B@lo}ph`5Rc;v" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const Rx_pin: SerialPin = SerialPin.P12" numlines="1" declaredvars="Rx_pin"></mutation><next><block type="typescript_statement" id=";nNF^,1Eva]tS1O1.A@8" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const LED_pin: DigitalPin = DigitalPin.P6" numlines="1" declaredvars="LED_pin"></mutation><next><block type="variables_set" id="*,0#(PZTgYCdCrKw~IK["><field name="VAR" id="V}dITmW#v,LO_,[qSx{R">SSID_1</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="}6_-SW$t.SdW4P}@|:A/"><field name="TEXT">your_wifi_ssid</field></block></value><next><block type="variables_set" id="xexX@2)tesKsZ,5,-w6I"><field name="VAR" id="V`ehez(uX4[-|=P6C:TQ">PASSWORD_1</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="lKfC[btf,xV`sd}otQ%%"><field name="TEXT">your_wifi_password</field></block></value><next><block type="variables_set" id="|7II%RR!H`Wn7I,O,:g0"><field name="VAR" id="fAyQ15?S,3?o$]Ae0vN@">SSID_2</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="^:O68|`=Pj5f)]Fs)99y"><field name="TEXT">ESP8266</field></block></value><next><block type="variables_set" id="=B=dDXeZ#ew}.*/mHD0^"><field name="VAR" id="lD%oltOw!+%Dum{U~oUI">PASSWORD_2</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="Ki*|Y!PR.ge2pl^vrZr9"><field name="TEXT">microbit</field></block></value><next><block type="typescript_statement" id="dk8pWeOX=BB2S.{4,;}1" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="pins.digitalWritePin(LED_pin, 0)" numlines="1"></mutation><next><block type="typescript_statement" id="1N]1kwYb1FBQd.INgXK)" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="serial.redirect(Tx_pin, Rx_pin, 115200)" numlines="1"></mutation><next><block type="typescript_statement" id="R+c7Uk|w@C$}/xB$d%aV" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+RESTORE&quot;, 1000)" numlines="1"></mutation><comment>設定ESP-01</comment><next><block type="typescript_statement" id="fVrRupC#RINy@|GA?g#j" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+RST&quot;, 1000)" numlines="1"></mutation><next><block type="typescript_statement" id="FnJb2.xhfwhs=@(PM1}O" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CWMODE=&quot; + WIFI_MODE)" numlines="1"></mutation><next><block type="controls_if" id="eqN!sOqSrr{Ae?_KU)6;"><mutation elseif="1"/><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="R?0DhxRe(4S}L}.^80w~"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="pL*b)p.K-dwpiIn4p6=d"><field name="VAR" id="}OizKB)-6aFr5q:Yr4.T">WIFI_MODE</field></block></value><value name="B"><shadow type="math_number" id="]KLY]?dDxm/;-wzh~rt%"><field name="NUM">1</field></shadow></value></block></value><statement name="DO0"><block type="typescript_statement" id="kU/T/mk[cmj%em5a@O^B" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CWJAP=\&quot;&quot; + SSID_1 + &quot;\&quot;,\&quot;&quot; + PASSWORD_1 + &quot;\&quot;&quot;)" numlines="1"></mutation><next><block type="typescript_statement" id="T9yDG3jV6n!MZfML0h^k" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let result: boolean = wait_for_response(&quot;OK&quot;)" numlines="1" declaredvars="result"></mutation><next><block type="controls_if" id="x?wmRmiV_*aeaTXORCTN"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="-Mn})I0g-q)JFVv13R]Y"><value name="BOOL"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="8vUI~vrode:~)5Q@Og21"><field name="VAR" id="DmTTO`)sndq?Cr?8S_)5">result</field></block></value></block></value><statement name="DO0"><block type="control_reset" id="+]Cvx!*H7cl$LNbb@*$K"/></statement></block></next></block></next></block></statement><value name="IF1"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="bNXmen#*^wIO3ve#n{7,"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="8(hhf:=TZk?RR})1Txo5"><field name="VAR" id="}OizKB)-6aFr5q:Yr4.T">WIFI_MODE</field></block></value><value name="B"><shadow type="math_number" id=",(`lgMh3%_fDW#G_f+*-"><field name="NUM">2</field></shadow></value></block></value><statement name="DO1"><block type="typescript_statement" id="hP__v%~^#eJcI4H@r|#i" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CWSAP=\&quot;&quot; + SSID_2 + &quot;\&quot;,\&quot;&quot; + PASSWORD_2 + &quot;\&quot;,1,4&quot;, 1000)" numlines="1"></mutation><comment>開放1個連線頻道, 驗證模式=4 (WPA_WPA2_PSK)</comment></block></statement><next><block type="typescript_statement" id="Nf]q2dW,Oh;~F(7QLk?j" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CIPMUX=1&quot;)" numlines="1"></mutation><comment>設定伺服器</comment><next><block type="typescript_statement" id="x%%4#b4*@Ac(UnoW!yAq" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CIPSERVER=1,80&quot;)" numlines="1"></mutation><next><block type="typescript_statement" id="%*%S2iRT`N_YFj5g/Ee," editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CIFSR&quot;)" numlines="1"></mutation><comment>顯示IP (在AP模式預設為192.168.4.1)</comment><next><block type="neopixel_set_strip_color" id="z%AR`+.28E,1E9xM8#[{"><value name="strip"><block type="variables_get" id="qe]w$}rWXwdDj#-%M5a#"><field name="VAR" id=",7f69~kN4}($qQ:zE6,*">strip</field></block></value><value name="rgb"><shadow type="neopixel_colors" id="rD=Yb?A@cZ#^vLwWEKeP"><field name="color">NeoPixelColors.Black</field></shadow></value><next><block type="basic_show_icon" id="]#mx26;YQb;O*q:DX@`?"><field name="i">IconNames.Yes</field><comment>顯示打勾圖案, 伺服器完成開啟</comment><next><block type="device_while" id="C;Fk@ra$$wr[@G/QI2G+"><comment>處理HTTP請求</comment><value name="COND"><shadow type="logic_boolean" id="21eHBb=o{p]Xcr0$]8/E"><field name="BOOL">TRUE</field></shadow></value><statement name="DO"><block type="variables_set" id="@B16pVo@x%z/Z:iiI9e["><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field><comment>儲存最長200字的序列資料, 以免loss掉</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text_join" id="{G}!E_F]z!~-Ftr-1IpR"><mutation items="3"/><value name="ADD0"><shadow type="text" id="!l%F3fP/jkZ~avjh)E|5"><field name="TEXT"/></shadow></value><value name="ADD1"><shadow type="text"><field name="TEXT"/></shadow><block type="variables_get" id="37=ZT7n;;6O#*lNcyr5Z"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field></block></value><value name="ADD2"><shadow type="text"><field name="TEXT"/></shadow><block type="serial_read_buffer" id="0}Yg$Ov({Die4PD32.%;"/></value></block></value><next><block type="controls_if" id="+#xeN1Hf9VVm^L^B8W]x"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="JT@]Zjm[DB:C8}/K9Z6@"><field name="OP">GT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text_length" id="|s`G6)P8wkk8Q?X=tX7{"><value name="VALUE"><block type="variables_get" id="*4a=H.fK5klD]B^:diwG"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field></block></value></block></value><value name="B"><shadow type="math_number" id="Ct4*bRoyH{EzaIaBJ-J@"><field name="NUM">200</field></shadow></value></block></value><statement name="DO0"><block type="variables_set" id="qvDghb!X=k9,.*OZGrb0"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="string_substr" id="_c58Ve-WD_`nk3npf4${"><value name="this"><shadow type="text"><field name="TEXT"/></shadow><block type="variables_get" id="VY-M2$YRSAHvE7WG6%xu"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field></block></value><value name="start"><block type="math_arithmetic" id="4`|EI.GWGx~I$+}wQaBd"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text_length" id="ojBD]x1?:kxZGoO7,8ca"><value name="VALUE"><block type="variables_get" id="v/N9i8b=#YZDg``Jt*DR"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field></block></value></block></value><value name="B"><shadow type="math_number" id="3|Z`XaG9zo)m$[MhFm-y"><field name="NUM">200</field></shadow></value></block></value><value name="length"><shadow type="math_number" id="DpK)eRONA-1jZEV7|iU;"><field name="NUM">0</field></shadow></value></block></value></block></statement><next><block type="controls_if" id="Z}%QIk4Cg{H!utS+|gRM"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="9v;@j}WY)65R-}24Bpja"><field name="OP">AND</field><value name="A"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="typescript_expression" id="d:t`_lcS%2UU]+1/gij8" editable="false"><field name="EXPRESSION">serial_str.includes("+IPD")</field></block></value><value name="B"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="typescript_expression" id="+JV(hp#PxvX=b1.6eW^+" editable="false"><field name="EXPRESSION">serial_str.includes("HTTP")</field></block></value></block></value><statement name="DO0"><block type="variables_set" id="(5Sz;W*#w.[`,`1M/Z=("><field name="VAR" id="Ve@lIP}hfBi#p-9g$`C5">client_ID</field><comment>有連線請求</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="string_substr" id="GTF5?$ZoNAqwC^JDPG$A"><value name="this"><shadow type="text"><field name="TEXT"/></shadow><block type="variables_get" id="7pFyzvU*T@)+b/k3cX+$"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field></block></value><value name="start"><block type="math_arithmetic" id="qI/cbmkaU/J;*4Qbi|`M"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="$Ea:-Kvyl?RRj{74]geI" editable="false"><field name="EXPRESSION">serial_str.indexOf("IPD")</field></block></value><value name="B"><shadow type="math_number" id="h9T;P$24y7hU5KZg%*g2"><field name="NUM">4</field></shadow></value></block></value><value name="length"><shadow type="math_number" id="0I^ST)0j,TD(1I#5ujwy"><field name="NUM">1</field></shadow></value></block></value><next><block type="typescript_statement" id="-Ak@+*!{Z.V;lnF3CR$!" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let GET_pos: number = serial_str.indexOf(&quot;GET&quot;)" numlines="1" declaredvars="GET_pos"></mutation><next><block type="typescript_statement" id="U],a3UtRHjb~07L_N6~-" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let HTTP_pos: number = serial_str.indexOf(&quot;HTTP&quot;)" numlines="1" declaredvars="HTTP_pos"></mutation><next><block type="variables_set" id="w86lon_(fr@Sd}i!lHan"><field name="VAR" id="H,F[Hcu~$:h[xaCdK`rC">GET_command</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="string_substr" id="S;gDy{*^JwWos8=k]gZ7"><value name="this"><shadow type="text"><field name="TEXT"/></shadow><block type="variables_get" id="Ik~#SUct=(9~Kz4]O)6~"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field></block></value><value name="start"><block type="math_arithmetic" id="amICAbV*{?Yv0N,c$o,+"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="/GDN=tSUKZD?)WdqoU~y"><field name="VAR" id="cSFqRp:bPq~IA+h,4GZj">GET_pos</field></block></value><value name="B"><shadow type="math_number" id="iPHH9{k_!`1W%U21A5.Z"><field name="NUM">5</field></shadow></value></block></value><value name="length"><block type="math_arithmetic" id="KHwry5^k,$O|;veTXgdR"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="vTGY*#A{{fBI}E[MMK^K"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="~kTOWrC,RQ.vPu9b#(sz"><field name="VAR" id="E]U,Ac0}siVq2xwur,2C">HTTP_pos</field></block></value><value name="B"><shadow type="math_number" id="V:sCcphsj?lS0[3t$le("><field name="NUM">1</field></shadow></value></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="{?BqDh5a.8sN|)UK6P8T"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="p*6~MdG6JA]@u:SHEz)#"><field name="VAR" id="cSFqRp:bPq~IA+h,4GZj">GET_pos</field></block></value><value name="B"><shadow type="math_number" id="Jzg/wMrwfyQPpb!w_zPa"><field name="NUM">5</field></shadow></value></block></value></block></value></block></value><next><block type="typescript_statement" id="bje$2~hP?t]3VE5En,A=" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (GET_command) {" line1="            case &quot;&quot;: // request 192.168.x.x/" line2="                GET_success = true" line3="                break" line4="            case &quot;LED&quot;: // request 192.168.x.x/LED" line5="                GET_success = true" line6="                LED_status = 1 - LED_status" line7="                pins.digitalWritePin(LED_pin, LED_status)" line8="" line9="                if (LED_status == 1) {" line10="                    strip.showColor(neopixel.colors(NeoPixelColors.White))" line11="                } else {" line12="                    strip.showColor(neopixel.colors(NeoPixelColors.Black))" line13="                }" line14="                strip.show()" line15="" line16="                break" line17="            case &quot;LEDON&quot;: // request 192.168.x.x/LED" line18="                GET_success = true" line19="                LED_status = 1" line20="                pins.digitalWritePin(LED_pin, LED_status)" line21="" line22="                if (LED_status == 1) {" line23="                    strip.showColor(neopixel.colors(NeoPixelColors.White))" line24="                } else {" line25="                    strip.showColor(neopixel.colors(NeoPixelColors.Black))" line26="                }" line27="                strip.show()" line28="" line29="                break" line30="            case &quot;LEDOFF&quot;: // request 192.168.x.x/LED" line31="                GET_success = true" line32="                LED_status = 0" line33="                pins.digitalWritePin(LED_pin, LED_status)" line34="" line35="                if (LED_status == 1) {" line36="                    strip.showColor(neopixel.colors(NeoPixelColors.White))" line37="                } else {" line38="                    strip.showColor(neopixel.colors(NeoPixelColors.Black))" line39="                }" line40="                strip.show()" line41="" line42="                break" line43="        }" numlines="44"></mutation><comment>判斷GET指令</comment><next><block type="typescript_statement" id="_4UJ2zAvV)z/sqHWu^Tt" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let HTML_str: string = getHTML(GET_success)" numlines="1" declaredvars="HTML_str"></mutation><comment>產生HTML並傳給使用者</comment><next><block type="typescript_statement" id="LBJL/(Hf6yxC96we6_.Y" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CIPSEND=&quot; + client_ID + &quot;,&quot; + (HTML_str.length + 2))" numlines="1"></mutation><next><block type="typescript_statement" id="jNc{;-_!cP:d/:,kuQdT" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(HTML_str, 1000)" numlines="1"></mutation><next><block type="typescript_statement" id="P2Xt+Sa^tV^K?x3,m6|5" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="sendAT(&quot;AT+CIPCLOSE=&quot; + client_ID)" numlines="1"></mutation><comment>關閉連線</comment><next><block type="variables_set" id="jUM3qOtwJ]ioRW5EgW,Q"><field name="VAR" id="Q8E,[I-7wj7bOCUL_uLI">serial_str</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="9Nwy@h[8xux!JMy8O4]D"><field name="TEXT"/></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></next></block></next></block></statement><next><block type="typescript_statement" id=",b86YHu@)O%,iAf(@Gy/" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function sendAT(command: string, waitTime: number = 100) {" line1="    serial.writeString(command + &quot;\u000D\u000A&quot;)" line2="    basic.pause(waitTime)" line3="}" numlines="4"></mutation><comment>寫入AT指令並加上CR+LF</comment><next><block type="typescript_statement" id="Wj,?XYuM]egs1w36i-WG" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function getHTML(normal: boolean): string {" line1="    let LED_statusString: string = &quot;&quot;" line2="    let LED_buttonString: string = &quot;&quot;" line3="    let web_title: string = &quot;TECH in the Box Wifi on micro:bit&quot;" line4="    let html: string = &quot;&quot;" line5="    html += &quot;HTTP/1.1 200 OK\r\n&quot;" line6="    html += &quot;Content-Type: text/html\r\n&quot;" line7="    html += &quot;Connection: close\r\n\r\n&quot;" line8="    html += &quot;&lt;!DOCTYPE html&gt;&quot;" line9="    html += &quot;&lt;html&gt;&quot;" line10="    html += &quot;&lt;head&gt;&quot;" line11="    html += &quot;&lt;link rel=\&quot;icon\&quot; href=\&quot;data:,\&quot;&gt;&quot;" line12="    html += &quot;&lt;title&gt;&quot; + web_title + &quot;&lt;/title&gt;&quot;" line13="    html += &quot;&lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1\&quot;&gt;&quot; // mobile view" line14="    html += &quot;&lt;/head&gt;&quot;" line15="    html += &quot;&lt;body&gt;&quot;" line16="    html += &quot;&lt;div style=\&quot;text-align:center\&quot;&gt;&quot;" line17="    html += &quot;&lt;h1&gt;&quot; + web_title + &quot;&lt;/h1&gt;&quot;" line18="    html += &quot;&lt;br&gt;&quot;" line19="    let NOT_LED_statusString = &quot;&quot;" line20="    if (normal) {" line21="        if (LED_status) {" line22="            LED_statusString = &quot;ON&quot;" line23="            LED_buttonString = &quot;TURN IT OFF&quot;" line24="            NOT_LED_statusString = &quot;OFF&quot;" line25="        } else {" line26="            LED_statusString = &quot;OFF&quot;" line27="            LED_buttonString = &quot;TURN IT ON&quot;" line28="            NOT_LED_statusString = &quot;ON&quot;" line29="        }" line30="        html += &quot;&lt;h3&gt;LED STATUS: &quot; + LED_statusString + &quot;&lt;/h3&gt;&quot;" line31="        html += &quot;&lt;br&gt;&quot;" line32="        html += &quot;&lt;input type=\&quot;button\&quot; onClick=\&quot;window.location.href=\'LED&quot; + NOT_LED_statusString + &quot;\'\&quot; value=\&quot;&quot; + LED_buttonString + &quot;\&quot;&gt;&quot;" line33="        html += &quot;&lt;br&gt;&quot;" line34="    } else {" line35="        html += &quot;&lt;h3&gt;ERROR: REQUEST NOT FOUND&lt;/h3&gt;&quot;" line36="    }" line37="    html += &quot;&lt;br&gt;&quot;" line38="    html += &quot;&lt;input type=\&quot;button\&quot; onClick=\&quot;window.location.href=\'/'\&quot; value=\&quot;Home\&quot;&gt;&quot;" line39="    html += &quot;&lt;/div&gt;&quot;" line40="    html += &quot;&lt;/body&gt;&quot;" line41="    html += &quot;&lt;/html&gt;&quot;" line42="    return html" line43="}" numlines="44"></mutation><comment>產生客戶端HTML</comment><next><block type="typescript_statement" id="7bGos9%wKfDMh];?mm=t" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function wait_for_response(str: string): boolean {" line1="    let result2: boolean = false" line2="    let time: number = input.runningTime()" line3="    while (true) {" line4="        serial_str += serial.readString()" line5="        if (serial_str.length &gt; 200) {" line6="            serial_str = serial_str.substr(serial_str.length - 200)" line7="        }" line8="        if (serial_str.includes(str)) {" line9="            result2 = true" line10="            break" line11="        }" line12="        if (input.runningTime() - time &gt; 300000) break" line13="    }" line14="    return result2" line15="}" numlines="16"></mutation><comment>等待wifi連線用</comment></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>